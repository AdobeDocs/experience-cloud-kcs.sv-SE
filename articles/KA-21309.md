---
title: "Exempel på request.log-analys | AEP"
description: Beskrivning
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, AEP, Request Log"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Amol Mahajan
article-created-date: "1/31/2023 11:02:06 AM"
article-published-by: Amol Mahajan
article-published-date: "1/31/2023 11:32:45 AM"
version-number: 3
article-number: KA-21309
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=f8c6eab1-56a1-ed11-aad1-6045bd0067ea"
source-git-commit: 1bb94ae378ff9bc9be605499bb222790e4aea393
workflow-type: tm+mt
source-wordcount: '968'
ht-degree: 0%

---

# Exempel på request.log-analys | AEP

## Beskrivning {#description}

<b>Miljö</b>
Experience Manager 6.5


<b>Problem/symtom</b>
Adobe Experience Manager (AEM) `request.log` innehåller olika användbar information, till exempel svarstid, för att analysera prestandaproblem. Här är en lista med exempel på analys med Linux-kommandon (inklusive några externa kommandon).




## Upplösning {#resolution}

<b>Innehållsförteckning:</b>
Introduktion Formatet på request.log

Förberedande steg

1. Datarensning
2. Starttid
3. Antal åtkomster per timme
4. Maximal samtidig bearbetning
5. Dela en loggfil
6. Sammanfoga begärandeposter och svarsposter




Exempel på analys

1. De tyngsta åtkomsten
2. Kommer åt svar som saknas
3. Långsam åtkomst
4. Tidsseriedata för svarstid
5. Minsta, medelvärde (genomsnitt), median, maximal svarstid
6. Antal åtkomster per period
7. Antal svarsstatusar per period
8. De vanligaste URL:erna
9. access.log-poster för en request.log-post


Slutsats

<b>Introduktion</b>



<u>Formatet på request.log</u>

AEM 6.5 genererar request.log i följande format som standard. På grund av en systembegränsning visas kommandoraden i den här artikeln som bilder i stället för som oformaterad text.

Exempel på request.log:
![](assets/e51bfd97-dd9b-ed11-aad1-6045bd006793.png)



I den här artikeln hänvisar jag till en rad med &quot;-&quot; som en&quot;begärandepost&quot;. En rad med&quot;-&quot; är en&quot;svarspost&quot;.

Begärandepost När en begäran tas emot av AEM loggas en begärandepost. Den innehåller datum och tid för mottagande, begärande-ID, begärandemetod och URL.

Svarspost När AEM svarar på en begäran loggas en svarspost. Den innehåller datum och tid för svar, begärande-ID, statuskod, innehållstyp och svarstid (i millisekunder).

Se även motsvarande handbok: https://experienceleague.adobe.com/docs/experience-manager-65/deploying/configuring/monitoring-and-maintaining.html?lang=en#interpreting-the-request-log

<b>Förberedelsesteg:</b>



<u>Steg 1. Datarensning</u>

Innan du börjar analysera request.log är det viktigt att standardisera loggposterna.

![](assets/2a1adef4-dd9b-ed11-aad1-6045bd006793.png)



Det första kommando som används tar bort ett extra utrymme i Content-Type för svarsposter för att förhindra felfältseparation med blanktecken. Kommandot ruby konverterar datumformatet till ISO 8601. Kommandot ruby separerar även datum och tid med tomt utrymme i stället för kolon.

<u>Steg 2. Starttid</u>

Startar om AEM och en installation av Service Pack återställer begäran-ID:t för request.log. Begärandeposterna med begärande-ID = 0 anger att det kan finnas sådana typer av åtgärder.

![](assets/777fcc1e-de9b-ed11-aad1-6045bd006793.png)



I exemplet ovan återställdes begäran-ID:n till 0 vid 13:08:49 och 13:26:13.

<u>Steg 3. Antal åtkomster per timme</u>

Räkna antalet åtkomstnivåer per timme och tidsintervallet för request.log.

![](assets/712fae49-de9b-ed11-aad1-6045bd006793.png)



<u>Steg 4. Maximal samtidig bearbetning</u>

Antalet samtidiga bearbetningar gör det lättare att gissa serverbelastningen på AEM.

![](assets/7b359b5c-de9b-ed11-aad1-6045bd006793.png)



Som standard är det maximala antalet samtidiga anslutningar för Jetty i AEM inställt på 200. Det är en fördröjning i att släppa socketen när svaret är klart. När antalet samtidiga behandlingar överstiger cirka 170 kan de inte godkänna nya begäranden.

<u>Steg 5. Dela en loggfil</u>

Begärande-ID för request.log återställs när AEM startas om eller när ett Service Pack installeras. På grund av detta kan analysen vara felaktig när request.log innehåller sådana åtgärder. Om du vill utföra en korrekt analys och minska filstorleken som hanteras samtidigt delar du request.log med hjälp av request records med begäran-ID = 0.

![](assets/a342906e-de9b-ed11-aad1-6045bd006793.png)



<u>Steg 6. Sammanfoga begärandeposter och svarsposter</u>

Genom att sammanfoga begäran- och svarsposter med begäran-ID blir det enklare att identifiera när prestandaproblem har startats. Jag kommer att använda den här sammanfogade loggfilen i de senare exemplen.

![](assets/e3848b8c-de9b-ed11-aad1-6045bd006793.png)



Det senast använda kommandot lägger till ett &quot;dummy&quot;-svar till begärandeposter som inte har någon motsvarande svarspost. Det kan också finnas svarsposter utan begärandeposter. Men de är okunniga eftersom de vanligtvis inte är till för utredning.

Den sammanfogade loggfilen ska se ut så här:

![](assets/79f3829e-de9b-ed11-aad1-6045bd006793.png)



<b>Exempel på analys</b>



<u>Exempel 1. De tyngsta åtkomsten</u>

Sortera den sammanfogade loggfilen efter svarstid i fallande ordning, inklusive åtkomst utan svar.

![](assets/50d9b9da-de9b-ed11-aad1-6045bd006793.png)



<u>Exempel 2. Kommer åt svar som saknas</u>

Extrahera-åtkomster saknar motsvarande svarsposter med hjälp av dummy-svarstiden.

![](assets/7bf0beed-de9b-ed11-aad1-6045bd006793.png)



Om tidpunkten för mottagande av åtkomst utan svar är korrelerad med en ökning av serverbelastningen, kan dessa åtkomster ha utlöst prestandaproblem.

![](assets/4c86bdff-de9b-ed11-aad1-6045bd006793.png)



<u>Exempel 3. Långsam åtkomst</u>

Extrahera åtkomster som tog mer än 10 sekunder.

![](assets/028e0518-df9b-ed11-aad1-6045bd006793.png)



När antalet träffar är för högt ersätter du 0-9{5} med 0-9{6} i grep-kommandot för att begränsa antalet till åtkomster som tog mer än 100 sekunder.

<u>Exempel 4. Tidsseriedata för svarstid</u>

Det kan vara bra att extrahera enbart tidsstämpeln och svarstiden från data för att skapa diagram.

![](assets/e200d731-df9b-ed11-aad1-6045bd006793.png)



Om du utelämnar åtkomst som svarat omedelbart blir informationen mer effektiv. Följande exempel extraherar åtkomst som tog mer än en sekund.

![](assets/ec4bd13d-df9b-ed11-aad1-6045bd006793.png)



<u>Exempel 5. Minsta, medelvärde (genomsnitt), median, maximal svarstid</u>



![](assets/523f6d50-df9b-ed11-aad1-6045bd006793.png)



I ovanstående exempel används datamash-kommandot (https://www.gnu.org/software/datamash/) för statistisk bearbetning. Om loggen innehåller åtkomst utan respons kommer det osäkra värdet att påverka resultatet.

<u>Exempel 6. Antal åtkomster per period</u>

Räkna antalet åtkomster per tio minuter. Resultatet hjälper till att avgöra om stor trafik orsakade ett prestandaproblem.

![](assets/16ffe970-df9b-ed11-aad1-6045bd006793.png)



I följande exempel begränsas data ned till enbart POSTER. Ett typiskt exempel är att avgöra om det finns en koncentration av redigering eller replikering av innehåll till publiceringsnivån.

![](assets/9447dd7c-df9b-ed11-aad1-6045bd006793.png)



<u>Exempel 7. Antal svarsstatusar per period</u>

Skapa en tabell med antalet svar per tio minuter med kommandot datamash.

![](assets/8a91d788-df9b-ed11-aad1-6045bd006793.png)



<u>Exempel 8. De vanligaste URL:erna</u>

Skriv ut de tre översta URL:erna som du oftast fick åtkomst till under tio minuter.

![](assets/a04efc9a-df9b-ed11-aad1-6045bd006793.png)



<u>Exempel 9. access.log-poster för en request.log-post</u>

Sök i access.log efter poster som motsvarar ett visst begärande-ID.

![](assets/891a02ad-df9b-ed11-aad1-6045bd006793.png)



Om flera åtkomster av samma URL samtidigt inträffar, visar resultatet flera access.log-poster för ett enda begäran-ID.

<b>Slutsats</b>

Jag hoppas att exemplen i den här artikeln kan hjälpa dig att analysera dina prestandaproblem.

Exemplen i listan har testats i CentOS 7.5 och Ubuntu 22.04LTS, men de kanske inte fungerar som förväntat beroende på din miljö, till exempel olika versioner eller variationer av kommandona. Justera dem efter de kommandon som är installerade i din miljö.


