---
title: "Implementera videoanalys i Adobe Launch"
description: Beskrivning
solution: Customer Journey Analytics,Analytics
product: Customer Journey Analytics,Analytics
applies-to: "Customer Journey Analytics,Analytics"
keywords: "KCS Launch Video Analytics Heartbeat"
resolution: Resolution
internal-notes: "This implementation discussed in this article does not use Adobe Launch extension for Media Analytics."
bug: false
article-created-by: Krunal Oza
article-created-date: "9/16/2022 9:07:03 AM"
article-published-by: Krunal Oza
article-published-date: "9/16/2022 9:25:26 AM"
version-number: 3
article-number: KA-15023
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=ee0b6fe9-9e35-ed11-9db1-002248086a9c"
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '1055'
ht-degree: 0%

---

# Implementera videoanalys i Adobe Launch

## Beskrivning

<br>Miljö<br><br>


I den här artikeln beskrivs hur du implementerar videospårning i YouTube i Adobe Launch med Media Heartbeat SDK.


<br><br>Problem/symtom<br><br>
<b>Krav</b>


| <ol>   <li>Du har en aktiv implementering av Adobe Launch.</li>   <li>Rapportsviten är aktiverad för Media Collection.</li>   <li>Rapportsviten mappas till rätt inloggningsföretag för Analytics i Adobe Experience Cloud.</li>   <li>Du har publiceringsrättigheter i Adobe Launch.</li>   <li>Du känner till användargränssnittet för Adobe Launch och hur det fungerar.</li>  </ol><br> |
| --- |



## Upplösning


<b>STEG 1: Skapa ny regel</b>

Skapa en ny regel i Adobe Launch-egenskapen genom att klicka på Lägg till regel på fliken Regler. Den här regeln innehåller händelsevillkoret för att läsa in YouTube-video samt API-skripten för Video Analytics och YouTube iFrame.

- Ange regelnamnet i textrutan Namn.




<b>STEG 2: Lägg till händelser och/eller villkor</b>

Klicka på + under Event and Conditions för att skapa villkor för att starta YouTube-videon. I mitt exempel har jag lagt till villkoret&quot;Element Exists&quot; för att söka efter en specifik div-spelare för att starta YouTube-videon.



<b>STEG 3: Lägg till åtgärder - Konfigurationsvariabler</b>

Klicka på + under åtgärder för att skapa ett nytt åtgärdsobjekt. Detta fungerar som en enda konfigurationspunkt för att konfigurera videoanalysvariabler. Jag har använt några hårdkodade värden. Du kan dock använda dataelement för att fylla i dessa variabler.

1. Välj Core (kärna) i listrutan Extension.
2. Välj Anpassad kod i listrutan Åtgärdstyp.
3. Lägg till åtgärdsnamn i textrutan Namn.
4. Välj&quot;Javascript&quot; under Språk.
5. Markera Kör globalt.
6. Klicka på Öppna redigerare.
7. Lägg till koden och klicka på Spara. Se till att du uppdaterar värdena enligt ditt företag och rapporterar en programsvit.



```
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
```


(function() { &#39;use strict&#39;;     // Exportera symboler.
    window.Configuration = { PLAYER: { NAME: &#39;exempelspelarens namn&#39; //VIDEO_ID: &#39;sample video id&#39;, //VIDEO_NAME: exempelvideonamn }, VISITOR: { MARKETING_CLOUD_ORG_ID: &#39;experience cloud ID&#39;, TRACKING_SERVER: &#39;spårningsserver&#39;, DPID: &#39;&#39;, DPUID: &#39;&#39; }, APP_MeasUREMENT: { RSID: &#39;report suite id&#39;, TRACKING_SERVER: &#39;spårningsserver&#39;, PAGE_NAME: &#39;page name&#39;, CHAR_SET: UTF-8 }, HEARTBEAT: { TRACKING_SERVER: &#39;server för pulsslagsspårning&#39;, UTGIVARE: &#39;publisher id&#39;, CHANNEL: &#39;channel&#39;, OVP: &#39;ovp name&#39;, SDK: sgk version, SSL: &#39;false&#39;, DEBUG: &#39;true&#39; }; })();



<b>STEG 4: Lägg till tjänst för besökar-ID för funktionsmakron</b>

Media Analytics behöver en instans av Visitor ID-tjänsten. Du måste hämta tjänstkoden för Visitor ID från Code Manager i Adobe Analytics-gränssnittet.

När du har laddat ned tjänstkoden för Visitor ID klickar du på + under åtgärder för att skapa ett nytt åtgärdsobjekt och sedan

1. Välj Core (kärna) i listrutan Extension.
2. Välj Anpassad kod i listrutan Åtgärdstyp.
3. Lägg till åtgärdsnamn i textrutan Namn.
4. Välj&quot;Javascript&quot; under Språk.
5. Markera Kör globalt.
6. Klicka på Öppna redigerare.
7. Längst ned lägger du till följande kod och klickar på Spara.
8. Längst ned lägger du till följande kod och klickar på Spara.


var visitor = Visitor.getInstance(&quot;Experience Cloud ID&quot;, { trackingServer: &quot;tracking server&quot;, // same as s.trackingServer trackingServerSecure: &quot; tracking server &quot; // same as.trackingServerSecure });

<b>STEG 5: Lägg till åtgärder - Utvärderingskod</b>

Media Analytics behöver en instans av Appmeasurement. Du måste hämta det från Code Manager i Adobe Analytics UI.

När du har laddat ned Appmeasurement-koden klickar du på + under åtgärder för att skapa ett nytt åtgärdsobjekt och sedan

1. Välj Core (kärna) i listrutan Extension.
2. Välj Anpassad kod i listrutan Åtgärdstyp.
3. Lägg till åtgärdsnamn i textrutan Namn.
4. Välj&quot;Javascript&quot; under Språk.
5. Markera Kör globalt.
6. Klicka på Öppna redigerare.
7. Lägg till tjänstkod för besökar-ID.
8. Lägg till följande kod högst upp och klicka på Spara.

<br><br><br>// Initiera AppMeasurement
<br>var s_account=&quot;report suite id&quot;
<br>var s=s_gi(s_account)
<br>/\*\*\*\*\*\*\*\* VISITOR ID SERVICE CONFIG - KRÄVER VisitorAPI.js \*\*\*\*\*\*\*\*/
<br>s.visitor=Visitor.getInstance(&quot;Experience Cloud ID&quot;)<br><br><br>
<b>STEG 6: Lägg till åtgärder - pulsslagskod</b>

Hämta SDK för pulsslag från [https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs](https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs).

När du har laddat ned pulsslagskoden klickar du på + under åtgärder för att skapa ett nytt åtgärdsobjekt och sedan

1. Välj Core (kärna) i listrutan Extension.
2. Välj Anpassad kod i listrutan Åtgärdstyp.
3. Lägg till åtgärdsnamn i textrutan Namn.
4. Välj&quot;Javascript&quot; under Språk.
5. Markera Kör globalt.
6. Klicka på Öppna redigerare.
7. Lägg till tjänstkod för besökar-ID.
8. Längst ned lägger du till följande kod och klickar på Spara.


//Skapa en lokal referens till MediaHeartbeat-klasserna

var MediaHeartbeat = ADB.va.MediaHeartbeat; var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig; var MediaHeartbeatDelegate = ADB.va.MediaHeartbeatDelegate;

//Initiering av pulsslag i media

var mediaConfig = new MediaHeartbeatConfig(); mediaConfig.trackingServer = Configuration.HEARTBEAT.TRACKING_SERVER; mediaConfig.playerName = Configuration.PLAYER.NAME; mediaConfig.channel = Configuration.HEARTBEAT.CHANNEL; mediaConfig.debugLogging = Configuration.HEARTBEAT.DEBUG;

mediaConfig.appVersion = Configuration.HEARTBEAT.SDK; mediaConfig.ssl = Configuration.HEARTBEAT.SDK; mediaConfig.ovp = Configuration.HEARTBEAT.OVP;

// Implementera protokollet MediaHeartbeatDelegate.
var mediaDelegate = new MediaHeartbeatDelegate();

// Initiera

var appMeasurement = new AppMeasurement(); appMeasurement.visitor = visitor; appMeasurement.trackingServer = Configuration.APP_MeasUREMENT.TRACKING_SERVER; appMeasurement.account = Configuration.APP_MeasUREMENT.RSID; appMeasurement.pageName = Configuration.APP_MeasUREMENT.PAGE_NAME; appMeasurement.charSet = Configuration.APP_MeasUREMENT.CHAR_SET; var contextData = { pageURL: document.URL, isUserLoggedIn: &quot;false&quot;, tvStation: &quot;Sample TV station&quot;, programmerare: &quot;Khurshid Alam&quot; }; var mediaInfo; var videostarted = false; var metaDataLoaded = false;



<b>STEG 7: Lägg till åtgärder - YouTube IFrame API-kod</b>

1. Välj Core (kärna) i listrutan Extension.
2. Välj Anpassad kod i listrutan Åtgärdstyp.
3. Lägg till åtgärdsnamn i textrutan Namn.
4. Välj&quot;Javascript&quot; under Språk.
5. Markera Kör globalt.
6. Klicka på Öppna redigerare.
7. Lägg till följande kod och klicka på Spara.


// 2. Den här koden läser in API-koden för IFrame Player asynkront.

var tag = document.createElement(&#39;script&#39;); tag.src = &quot;https://www.youtube.com/iframe_api&quot;; var firstScriptTag = document.getElementsByTagName(&#39;script&#39;)0; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3. Den här funktionen skapar en iframe (och YouTube player) // efter att API-koden har hämtats.

var player; function onYouTubeIframeAPIReady() { console.log(&quot;onYouTubeIframeAPIReady called...&quot;);        player = new YT.Player(&#39;player&#39;, { height: 390, bredd: 640, videoId: &#39;xWYHvIjvMnY&#39;, händelser: { &#39;onReady&#39;: onPlayerReady, &#39;onStateChange&#39;: onPlayerStateChange, &#39;onPlaybackQualityChange&#39;: onPlayerPlaybackQualityChange, &#39;onPlaybackRateChange&#39;: onPlayerPlaybackRateChange, &#39;onError&#39;: onPlayerError }); }

// 4. API:t anropar den här funktionen när videospelaren är klar.

function onPlayerReady(event) { metaDataLoaded = true;        player.playVideo(); }

// 5. API:t anropar den här funktionen när spelarens läge ändras.
// Funktionen indikerar att spelaren ska spelas upp i sex sekunder och sedan stoppas när en video (state=1) spelas upp.

function onPlayerStateChange(event) { switch (event.data){ case YT.PlayerState.PLAYING: console.log(&quot;\*\*\*HB Playing&quot;);                      if(metaDataLoaded){ if (Math.floor(event.target.getCurrentTime()) == 0) { console.log(&quot;\*\*\*HB Start&quot;);                                    MediaHeartbeat = ADB.va.MediaHeartbeat;                                    mediaInfo = MediaHeartbeat.createMediaObject( event.target.getVideoData().title, event.target.getVideoData().video_id, Math.floor(event.target.getDuration()), MediaHeartbeat.StreamType.VOD ); MediaHeartbeat = new MediaHeartbeat(mediaDelegate, mediaConfig, appMeasurement);                                    mediaDelegate.getCurrentPlaybackTime = function() { return Math.floor(event.target.getCurrentTime());                            };                                    MediaHeartbeat.trackSessionStart(mediaInfo, contextData);                                    MediaHeartbeat.trackPlay();                                    videostarted = true;                      } else { console.log(&quot;\*\*\*HB Play&quot;);                            MediaHeartbeat.trackPlay();                      }} break;               case YT.PlayerState.PAUSED:                      console.log(&quot;\*\*\*HB Pause&quot;);                      MediaHeartbeat.trackPause();                      break,               case YT.PlayerState.ENDED:                      console.log(&quot;\*\*\*HB Ended&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      break,               case -1:                      console.log(&quot;\*\*\*HB unloaded&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      break,        }

}

function onPlayerPlaybackQualityChange(event) { console.log(&quot;onPlayerPlaybackQualityChange: event.data: &quot;+ event.data); }

function onPlayerPlaybackRateChange(event) { console.log(&quot;onPlayerPlaybackRateChange: event.data: &quot;+ event.data); }

function onPlayerError(event) { console.log(&quot;onPlayerError: event.data: &quot;+ event.data); }



<b>STEG 8: Lägg till HTML</b>

Lägg till följande kod i HTML-koden.

!-- 1. Den här div-taggen ersätts av iframe (och videospelaren). — div id=&quot;player&quot;/divbr

<b>STEG 8: Publicera</b>

Publicera din egendom och testa.


