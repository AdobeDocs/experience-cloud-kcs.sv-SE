---
title: Använda och förstå variabler
description: Beskrivning
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 5:36:09 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 1:51:43 PM
version-number: 1
article-number: KA-17487
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=1280b65e-9532-ec11-b6e5-000d3a5ba97a
exl-id: 86b5580e-134f-40d7-a126-45a38b8beaec
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '926'
ht-degree: 0%

---

# Använda och förstå variabler

## Beskrivning


I det här dokumentet beskrivs hur du kan utnyttja funktionerna i variabler i [!DNL Apache] webbserver och konfigurationsfiler för din dispatcherns modul.
<br><br><br><br>Variabler<br><br><br><br> <br><br>
[!DNL Apache] stöder variabler och sedan version 4.1.9 av [!DNL Dispather] och har också stöd för dem!

Vi kan utnyttja dessa för att göra många användbara saker som:

- Kontrollera att allt som är miljöspecifikt inte är infogat i konfigurationerna utan extraheras för att säkerställa att konfigurationsfilerna från dev fungerar med samma funktionella utdata.
- Växla mellan funktioner och ändra loggnivåer för oföränderliga filer som AMS tillhandahåller och du kan inte ändra dem.
- Ändra vilket inkluderar att använda baserat på variabler som `RUNMODE` och `ENV_TYPE`
- Matcha `DocumentRoot`och `VirtualHost` DNS-namn mellan [!DNL Apache] konfigurationer och modulkonfigurationer.



## Upplösning

<br><br>Använda baslinjevariabler<br><br><br><br> <br><br>
Eftersom AMS baslinjefiler är skrivskyddade och oföränderliga finns det funktioner som kan inaktiveras och aktiveras, liksom konfigureras genom redigering av de variabler som de använder.
<br><br><br><br> <br><br>Baslinjevariabler<br><br><br><br> <br><br>
Här är ett exempel på filens innehåll <b>`/etc/httpd/conf.d/variables/ams_default.vars`</b>
<br><br><br><br><br> <br><br><br><br>

` Define DISP_LOG_LEVEL info Define AUTHOR_WHITELIST_ENABLED 0 Define PUBLISH_WHITELIST_ENABLED 0 Define AUTHOR_FORCE_SSL 1 Define PUBLISH_FORCE_SSL 0 `

<br><br><br><br><br> <br><br>Exempel 1 - Tvinga SSL<br><br><br><br> <br><br>
Variablerna ovan <b>`AUTHOR_FORCE_SSL`</b>, eller <b>`PUBLISH_FORCE_SSL`</b> kan ställas in på 1 för att koda om omskrivningsregler som tvingar slutanvändare när de kommer in på http-begäran att omdirigeras till https

Här är konfigurationsfilens syntax som gör att den här växlingen fungerar:
<br><br><br><br><br> <br><br><br><br>

`/VirtualHost *:80      IfModule mod_rewrite.c          ReWriteEngine    on          If "${PUBLISH_FORCE_SSL} == 1" Include /etc/httpd/conf.d/rewrites/forcessl_rewrite.rules          /If      /IfModule /VirtualHost`

<br><br><br><br><br> <br><br>
Som du kan se är reglerna för omskrivning vad som har koden som omdirigerar slutanvändarens webbläsare, men variabeln som anges till 1 är vad som gör att filen kan användas eller inte
<br><br><br><br> <br><br>Exempel 2 - Loggningsnivå<br><br><br><br> <br><br>
Variablerna <b>`DISP_LOG_LEVEL`</b> kan användas för att ange vad du vill ha för loggnivån som faktiskt används i den konfiguration som körs.

Här är syntaxexemplet som finns i AMS-konfigurationsfilerna för baslinjen:
<br><br><br><br><br> <br><br><br><br>

`IfModule disp_apache2.c      DispatcherLog    logs/dispatcher.log      DispatcherLogLevel ${DISP_LOG_LEVEL} /IfModule`

<br><br><br><br><br> <br><br>
Om du behöver öka loggningsnivån för dispatcher behöver du bara uppdatera `ams_default.vars` variabel <b>`DISP_LOG_LEVEL`</b> till den nivå du vill ha.

Exempelvärden kan vara ett heltal eller ordet:
<br><br><br><br> <br>

| Loggnivå | Heltalsvärde | Word-värde |
| --- | --- | --- |
| Kalkera | 4 | trace |
| Felsök | 3 | debug |
| Info | 2 | info |
| Varning | 1 | varna |
| Fel | 0 | error |

<br><br><br> <br><br>Exempel 3 - Vitalister<br><br><br><br> <br><br>
Variablerna <b>`AUTHOR_WHITELIST_ENABLED`</b> och <b>`PUBLISH_WHITELIST_ENABLED`</b> kan anges till 1 för att aktivera regler för omskrivning som innehåller regler som tillåter eller tillåter inte användartrafik baserat på IP-adress.  Om du vill aktivera den här funktionen måste du kombinera den med att skapa en whitelist-regelfil så att den kan inkluderas.

Här är några syntaxexempel på hur variabeln aktiverar inkluderingen av vitlistfiler och ett exempel på vitlistfiler

<b>`sample.vhost`:</b>
<br><br><br><br><br> <br><br><br><br>

`VirtualHost *:80      Directory /          If "${AUTHOR_WHITELIST_ENABLED} == 1"              Include /etc/httpd/conf.d/whitelists/*_whitelist.rules          /If      /Directory /VirtualHost`

<br><br><br><br><br> <br><br>
<b>`sample_whitelist.rules`</b>:
<br><br><br><br><br> <br><br><br><br>

`RequireAny    Require ip 10.43.0.10/24 /RequireAny`

<br><br><br><br><br> <br><br>
Som du kan se *`sample_whitelist.rules`* tvingar IP-begränsningen men om variabeln växlas kan den inkluderas i *`sample.vhost`*
<br><br><br><br> <br><br>Variabler<br><br><br><br> <br><br>Startargument för webbserver<br><br><br><br> <br><br>
AMS placerar globala variabler i startargumenten för [!DNL Apache] bearbeta i filen <b>`/etc/sysconfig/httpd`</b>

Den här filen har fördefinierade variabler som visas här:
<br><br><br><br><br> <br><br><br><br>

AUTHOR_IP=&quot;10.43.0.59&quot; AUTHOR_PORT=&quot;4502&quot; AUTHOR_DOCROOT=&#39;/mnt/var/www/author&#39; PUBLISH_IP=&quot;10.43.0.20&quot; PUBLISH_PORT=&quot;4503&quot; PUBLISH_DOCROOT=&#39;/mnt/var/www/html&#39; ENV_TYPE=&#39;dev&#39; RUNMODE=&#39;dev&#39;

<br><br><br><br><br> <br><br>
Detta är inte något du kan ändra, men det är bra att utnyttja i dina konfigurationsfiler

Obs!

På grund av att den här filen bara inkluderas när tjänsten startas.  Tjänsten måste startas om för att ändringarna ska kunna hämtas.  Det räcker inte med en omladdning, men du måste starta om i stället


<br><br><br><br> <br><br>Variabelfiler (`.vars`)<br><br><br><br> <br><br>
Anpassade variabler som anges i koden ska finnas i *`.vars`*filer i katalogen <b>`/etc/httpd/conf.d/variables/`</b>

De här filerna kan innehålla valfria anpassade variabler och vissa syntaxexempel kan visas i följande exempelfiler

<b>`/etc/httpd/conf.d/variables/weretail_domains_dev.vars`</b>:
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN dev.weretail.com Define WERETAIL_ALT_DOMAIN dev.weretail.net`

<br><br><br><br><br> <br><br>
<b>`/etc/httpd/conf.d/variables/weretail_domains_stage.vars`:</b>
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN stage.weretail.com` `Define WERETAIL_ALT_DOMAIN stage.weretail.net`


<br><br><br><br><br> <br><br>
<b>`/etc/httpd/conf.d/variables/weretail_domains_prod.vars`</b>:
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN www.weretail.com Define WERETAIL_ALT_DOMAIN www..weretail.net`

<br><br><br><br><br> <br><br>
När du skapar egna variabler namnger filerna enligt deras innehåll och följer namngivningsstandarderna i handboken [här](https://helpx.adobe.com/experience-manager/kb/ams-dispatcher-manual/explanation-config-files.html#naming-convention).  I exemplet ovan ser du att variabelfilen är värd för de olika DNS-posterna som variabler som ska användas i konfigurationsfilerna.
<br><br><br><br> <br><br>Använda variabler<br><br><br><br> <br><br>
Nu när du har definierat variablerna i dina variabelfiler vill du veta hur du använder dem på rätt sätt i dina andra konfigurationsfiler.

Vi ska använda exemplet `.vars` filer ovan för att illustrera ett korrekt användningssätt.

Vi vill inkludera alla miljöbaserade variabler globalt så skapar vi filen <b>`/etc/httpd/conf.d/000_load_env_vars.conf`</b>

`Include /etc/httpd/conf.d/variables/*_${ENV_TYPE}.vars Include /etc/httpd/conf.d/variables/*_${RUNMODE}.vars`

<br><br><br><br><br> <br><br>
Vi vet att när httpd-tjänsten startas hämtas den in de variabler som AMS anger i <b>`/etc/sysconfig/httpd`</b> och har variabeluppsättningen <b>`ENV_TYPE`</b> och <b>`RUNMODE`</b>

När denna globala `.conf` filen hämtas in tidigt eftersom filernas inbördes ordning `conf.d` är en alfanumerisk inläsningsordning som innebär 000 i filnamnet, vilket garanterar att det läses in före de andra filerna i katalogen.

Programsatsen include använder också en variabel i filnamnet.  Detta kan ändra vilken fil som läses in baserat på vilket värde som finns i `ENV_TYPE` och `RUNMODE` variabler.

Om *`ENV_TYPE`* värdet är <b>`dev`</b> så är filen som används:

<b>`/etc/httpd/conf.d/variables/weretail_domains_dev.vars`</b>

Om *`ENV_TYPE`* värdet är <b>`stage`</b> så är filen som används:

<b>`/etc/httpd/conf.d/variables/weretail_domains_stage.vars`</b>

Om `RUNMODE` värdet är <b>`preview`</b> så är filen som används:

<b>`/etc/httpd/conf.d/variables/weretail_domains_preview.vars`</b>

När den filen inkluderas kan vi använda de variabelnamn som lagrats i den.

I vår <b>`/etc/httpd/conf.d/available_vhosts/weretail.vhost`</b> kan vi byta ut den normala syntaxen som bara fungerade för dev:


```
VirtualHost *:80      ServerName    dev.weretail.com      ServerAlias    dev.weretail.net |
```

Med en nyare syntax som utnyttjar kraften i variabler för att arbeta med dev, stage och prod:

```
VirtualHost *:80      ServerName    ${WERETAIL_DOMAIN}      ServerAlias    ${WERETAIL_ALT_DOMAIN}
```


I vår <b>`/etc/httpd/conf.dispatcher.d/vhosts/weretail_vhosts.any`</b> kan vi byta ut den normala syntaxen som bara fungerade för dev:


```
"dev.weretail.com" "dev.weretail.net"
```


Med den nyare syntaxen som använder variablerna för att arbeta med dev, stage och prod:


```
"${WERETAIL_DOMAIN}" "${WERETAIL_ALT_DOMAIN}" 
```

<br><br><br><br><br> <br><br>
Dessa variabler har en enorm mängd återanvändning för att anpassa körningsinställningar utan att behöva ha olika distribuerade filer per miljö.  Du kan i stort sett mallanpassa konfigurationsfilerna med hjälp av variabler och inkludera filer som är baserade på variabler.
