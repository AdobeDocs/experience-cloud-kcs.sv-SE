---
title: "AEM tråddumpsanalys"
description: Beskrivning
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:11:03 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:13:37 PM"
version-number: 2
article-number: KA-16458
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=e70a8345-6587-eb11-a812-000d3a593216"
exl-id: 74bb70e4-a09b-48fc-8378-96a1736e5ebf
source-git-commit: a59847e2e7e37f432cb01150b9444cd9dbf585df
workflow-type: tm+mt
source-wordcount: '1000'
ht-degree: 0%

---

# AEM Tråddumpsanalys

## Beskrivning

Analysera AEM [!DNL Java] tråd dumpar med [IBM Thread Analyzer](http://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) verktyg.

## Upplösning

1. Hämta och installera [IBM Thread Analyzer](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) (vi kallar det IBM TDA kort)
1. Hämta [tråddumpar](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html) från en AEM som har prestandaproblem.
1. Öppna trådsdumpar i IBM TDA.
1. Om du vill visa information om en tråddump markerar du filen i listan och klickar sedan på knappen &quot;Tråddetalj&quot;\*.

![tda-threaddetail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1587732783/tda-threaddetail.png "tda-threaddetail")

1. Sortera efter &quot;Staplingsdjup&quot; med de längsta högarna överst.

   ![tda-image1](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image/tda-image1.png)

1. Granska trådarna med ett staplingsdjup på 10 rader eller längre.  Det är vanligtvis de trådar som intresserar dig mest.  Anteckna trådar som är intressanta.
1. Sortera efter tråd &quot;Tillstånd&quot;
1. Bläddra nedåt till de rundningsbara trådarna. Runda trådar är de som aktivt tog upp processortid när trådsdumpen togs.

   *Obs! När du granskar &quot;Runable&quot;-trådar kan du ignorera trådar som listas i [Trådar som kan ignoreras](https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html#ignorethreads) längst ned på den här sidan.*

1. Sök efter körbara trådar som ingår i programmet, till exempel jobbtrådar i bakgrunden eller frågetrådar (begärantrådar har namn som detta *127.0.0.1 1347028187737 GET /content/sites/global/en/sitemap.static-delivery.httpd.html HTTP/1.1*). När du har hittat dem klickar du på dem en i taget.

1. För varje frågetråd kan du ta reda på när användarens webbläsare gjorde begäran till servern genom att titta på tidsstämpeln i trådens namn.  I trådnamnet ovan är tidsstämpeln (i millisekunder unix epoch-format) 1347028187737.  Vi kan konvertera det epoknumret till ett datum/tid med [www.epochconverter.com](http://www.epochconverter.com/).  Varje tråddump visar datum och tid då den togs.  Du kan ta skillnaden i tid mellan begärandetiden och tråd-dumptiden för att se hur länge en begäran har varit aktiv.

1. När du har granskat begärantrådarna bläddrar du igenom de andra &quot;rundningsbara&quot; trådarna.  När du har hittat en &quot;Runnable&quot; thread of interest ska du titta på den mellersta panelen, &quot;Witing threads&quot;.  De trådar som visas väntar på att den markerade tråden ska släppa en bildskärm.  Om du inte ser några väntande trådar kan den markerade tråden fortfarande vara ägare av en [Lås](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) (se implementera klasser av [Lås](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) för mer information). Med en [ReentrantReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html) du inte kan se vilken tråd som är låshållare eftersom låser implementerar flera bildskärmar internt.  Du kanske måste titta på källkoden för att matcha den med en tråd som kan vara låshållare.

1. Om tråden hade ett lås eller en bildskärm som många andra trådar väntade på går du igenom resten av trådarna för att se om du kan hitta andra trådar som har samma problem.  Se om samma tråd fortfarande finns på de andra platserna (i IBM TDA kan du välja flera trådar och klicka på knappen &quot;Jämför trådar&quot;\* för att visa en trådstatus över flera trådar.

   ![tda-comparethreads](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1159496390/tda-comparethreads.png)

1. Se Samlingstjänsten i skärmbilden nedan:

   ![tda-Image2](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1730877898/tda-Image2.png)

1. I den här vyn kan du se tråden över flera trådar för att se om den är en tråd som körs länge.  Om tråden är i körbart läge över flera dumpar och har en lång hög innebär det vanligtvis att den är en tråd som körs länge.

1. Om du inte hittade så mycket av de körbara trådarna går du tillbaka till listan över trådar och väljer en tråddump. Klicka sedan på knappen &quot;Skärmdetalj&quot;\* på den övre panelen. IBM TDA öppnar ett fönster som visar en trädvy över övervakarägande trådar och deras vänttrådar. Obs! Det kan visa vissa trådpoolstrådar, t.ex. övervakaren för servermotortrådens trådpool, medan inaktiva trådar kan ignoreras.  Vanligtvis kan du se att en tråd är en tråd i en trådpool eftersom de för det mesta bara har 10 stackrader eller färre.

![tda-monitor-detail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1106466084/tda-monitordetail.png)

<b>CPU-användning på trådnivå ([!DNL Linux] endast plattform):</b>

1. Om du hämtade utdata av typen&quot;top -H -b -n1 -p javapid&quot; utöver tråddumpar kan du korsreferera till CPU-användningen på trådnivå.  Öppna de översta utdata och hämta process-ID för de trådar som använder processorn.  Konvertera process-ID:t till hexadecimalt och sök sedan efter det hexadecimala värdet i motsvarande tråddumpfil.  ID:t måste matcha &quot;nid&quot; för en av trådarna.
1. Om den matchande tråd som använder mest CPU är den virtuella datortråden eller någon GC-tråd, kan det bero på ett minnesproblem.  Upprepa samma övning om du vill ha fler tråddumpar och topputdata. Om det finns ett mönster med dessa trådar som tar processortid har du ett minnesproblem.
1. Om du har bekräftat minnesproblemet kan du hämta en heap-dump nästa gång problemet inträffar.  Se [den här artikeln](https://helpx.adobe.com/experience-manager/kb/AnalyzeMemoryProblems.html) om du vill ha mer information om hur du hämtar och analyserar stackdumpar.

![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)

Trådar som kan ignoreras:

- VM-tråd: Detta är en VM-systemtråd.
- Trådar som börjar med GC-aktivitetstråd: Det här är skräpinsamlingstrådar.
- Trådar med namn som liknar - 1347028691218 i kod på java.net.PlainSocketImpl.socketAccept(Native Method): Det här är trådar från servermodulens trådpool som väntar på nya anslutningar.
